{*********************************} UNIT Xray_Energies;{*********************************}  {**********************************} INTERFACE {**********************************} USES QuickDraw, QuickdrawText, Types, OSUtils, ToolUtils, Timer, Events, Errors, Menus, Files, Lists, Memory, Resources, Packages, Printing, Icons, TextEdit, TextUtils, Finder, Fonts, PasLibIntf, Windows, Retrace, SegLoad, Sound, Dialogs, fenv, fp, Controls, Spectrum_Structures, Declarations, INITIALIZE, xray;    PROCEDURE Get_Energies(atm_num: integer);{******************************} IMPLEMENTATION {**********************************}{$S Xray_Energies_x}  PROCEDURE Calibrate_Energies; { Called only once in Get_Energies below }    VAR  	index		: integer;    BEGIN {Calibrate_Energy_Scale means use values from Calibrate Window.	       These may be file values, if one is open, or calibrate values.		   These values are written to the Work spectrum.		   Otherwise use slope = 1 and intercept = 0 : just dE.		   What if there is no file??? We have to use Work values. }	(* if (Calibrate_Energy_Scale) then	    begin		   Cal_vals.Energy_Slope := Plt_Spec[10]^^.Expt_Info.Energy_Slope;		   Cal_vals.Energy_Intercept := Plt_Spec[10]^^.Expt_Info.Energy_Intercept;		end		else begin		   Cal_vals.Energy_Slope := 1.0;		   Cal_vals.Energy_Intercept := 0.0;		end;    *)      WITH Cal_vals DO        BEGIN          A^.edge[1] := Energy_Slope * A^.edge[1] + Energy_Intercept;          A^.edge[2] := Energy_Slope * A^.edge[2] + Energy_Intercept;          A^.edge[3] := Energy_Slope * A^.edge[3] + Energy_Intercept;          A^.edge[4] := Energy_Slope * A^.edge[4] + Energy_Intercept;          A^.edge[5] := Energy_Slope * A^.edge[5] + Energy_Intercept;          A^.edge[6] := Energy_Slope * A^.edge[6] + Energy_Intercept;          A^.edge[7] := Energy_Slope * A^.edge[7] + Energy_Intercept;          A^.edge[8] := Energy_Slope * A^.edge[8] + Energy_Intercept;          A^.edge[9] := Energy_Slope * A^.edge[9] + Energy_Intercept;          A^.edge[10] := Energy_Slope * A^.edge[10] + Energy_Intercept;		  A^.edge[11] := Energy_Slope * A^.edge[11] + Energy_Intercept;		  A^.edge[12] := Energy_Slope * A^.edge[12] + Energy_Intercept;		  A^.edge[13] := Energy_Slope * A^.edge[13] + Energy_Intercept;		  A^.edge[14] := Energy_Slope * A^.edge[14] + Energy_Intercept;		  A^.edge[15] := Energy_Slope * A^.edge[15] + Energy_Intercept;		  A^.edge[16] := Energy_Slope * A^.edge[16] + Energy_Intercept;		  A^.edge[17] := Energy_Slope * A^.edge[17] + Energy_Intercept;		  		  FOR index := 1 to 144 DO 		  	eV_Line[index] := Energy_Slope * eV_Line[index] + Energy_Intercept;		          END; {with...}    END; { PROCEDURE Calibrate_Energies }  {$S Xray_Energies1x}      PROCEDURE Clear_Energies;    VAR  	index		: integer;  		BEGIN      Atomic_Weight := 0.0;      Element_Density := 0.0;      A^.edge[1] := 0.0;      A^.edge[2] := 0.0;      A^.edge[3] := 0.0;      A^.edge[4] := 0.0;      A^.edge[5] := 0.0;      A^.edge[6] := 0.0;      A^.edge[7] := 0.0;      A^.edge[8] := 0.0;      A^.edge[9] := 0.0;      A^.edge[10] := 0.0;	  A^.edge[11] := 0.0;	  A^.edge[12] := 0.0;	  A^.edge[13] := 0.0;	  A^.edge[14] := 0.0;	  A^.edge[15] := 0.0;	  A^.edge[16] := 0.0;	  A^.edge[17] := 0.0;      For index := 1 to 144 do begin      	eV_Line[index] := 0.0;      	Wt_Line[index] := 0.0;      end;      	END;  {$S Xray_Energies2x}  PROCEDURE Get_Energies { ( atm_num : integer ) } ;    BEGIN	  Clear_Energies;      Z := atm_num;      IF (atm_num >= 3) AND (atm_num <= 95) THEN A^.edge[1] := K_ABS_Handle^^.Data[atm_num].Value;      IF (atm_num >= 8) AND (atm_num <= 95) THEN A^.edge[2] := LI_ABS_Handle^^.Data[atm_num].Value;      IF (atm_num >= 10) AND (atm_num <= 95) THEN A^.edge[3] := LII_ABS_Handle^^.Data[atm_num].Value;      IF (atm_num >= 10) AND (atm_num <= 95) THEN A^.edge[4] := LIII_ABS_Handle^^.Data[atm_num].Value;      IF (atm_num >= 18) AND (atm_num <= 95) THEN A^.edge[5] := MI_ABS_Handle^^.Data[atm_num].Value;      IF (atm_num >= 20) AND (atm_num <= 95) THEN A^.edge[6] := MII_ABS_Handle^^.Data[atm_num].Value;      IF (atm_num >= 21) AND (atm_num <= 95) THEN A^.edge[7] := MIII_ABS_Handle^^.Data[atm_num].Value;      IF (atm_num >= 33) AND (atm_num <= 95) THEN A^.edge[8] := MIV_ABS_Handle^^.Data[atm_num].Value;      IF (atm_num >= 33) AND (atm_num <= 95) THEN A^.edge[9] := MV_ABS_Handle^^.Data[atm_num].Value;      IF (atm_num >= 35) AND (atm_num <= 95) THEN A^.edge[10] := NI_ABS_Handle^^.Data[atm_num].Value;	  IF (atm_num >= 39) AND (atm_num <= 95) THEN A^.edge[11] := NII_ABS_Handle^^.Data[atm_num].Value;	  IF (atm_num >= 40) AND (atm_num <= 95) THEN A^.edge[12] := NIII_ABS_Handle^^.Data[atm_num].Value;	  IF (atm_num >= 49) AND (atm_num <= 95) THEN A^.edge[13] := NIV_ABS_Handle^^.Data[atm_num].Value;	  IF (atm_num >= 57) AND (atm_num <= 95) THEN A^.edge[14] := NV_ABS_Handle^^.Data[atm_num].Value;	  IF (atm_num >= 73) AND (atm_num <= 95) THEN A^.edge[15] := NVI_ABS_Handle^^.Data[atm_num].Value;	  IF (atm_num >= 73) AND (atm_num <= 95) THEN A^.edge[16] := NVII_ABS_Handle^^.Data[atm_num].Value;	  IF (atm_num >= 65) AND (atm_num <= 95) THEN A^.edge[17] := NOl_ABS_Handle^^.Data[atm_num].Value;      IF (atm_num >= 1) AND (atm_num <= 95) THEN Atomic_Weight := At_Wt^^.Value[atm_num];      IF (atm_num >= 1) AND (atm_num <= 95) THEN Element_Density := RHO_Handle^^.Value[atm_num];      IF (atm_num >= 72) AND (atm_num <= 83) THEN        BEGIN          eV_Line[8] := L1M1_Handle^^.Data[atm_num].Lamda;          Wt_Line[8] := L1M1_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 72) AND (atm_num <= 95) THEN        BEGIN          eV_Line[9] := L1N1_Handle^^.Data[atm_num].Lamda;          Wt_Line[9] := L1N1_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 71) AND (atm_num <= 95) THEN        BEGIN          eV_Line[10] := L1N4_Handle^^.Data[atm_num].Lamda;          Wt_Line[10] := L1N4_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 70) AND (atm_num <= 95) THEN        BEGIN          eV_Line[21] := L2M2_Handle^^.Data[atm_num].Lamda;          Wt_Line[21] := L2M2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 73) AND (atm_num <= 95) THEN        BEGIN          eV_Line[22] := L2M5_Handle^^.Data[atm_num].Lamda;          Wt_Line[22] := L2M5_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 73) AND (atm_num <= 83) THEN        BEGIN          eV_Line[23] := L2N2_Handle^^.Data[atm_num].Lamda;          Wt_Line[23] := L2N2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 72) AND (atm_num <= 95) THEN        BEGIN          eV_Line[25] := L2N5_Handle^^.Data[atm_num].Lamda;          Wt_Line[25] := L2N5_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 70) AND (atm_num <= 95) THEN        BEGIN          eV_Line[26] := L2O2_Handle^^.Data[atm_num].Lamda;          Wt_Line[26] := L2O2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 72) AND (atm_num <= 95) THEN        BEGIN          eV_Line[27] := L2O3_Handle^^.Data[atm_num].Lamda;          Wt_Line[27] := L2O3_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 88) AND (atm_num <= 95) THEN        BEGIN          eV_Line[28] := L2P2_Handle^^.Data[atm_num].Lamda;          Wt_Line[28] := L2P2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 72) AND (atm_num <= 95) THEN        BEGIN          eV_Line[37] := L3N2_Handle^^.Data[atm_num].Lamda;          Wt_Line[37] := L3N2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 72) AND (atm_num <= 95) THEN        BEGIN          eV_Line[38] := L3N3_Handle^^.Data[atm_num].Lamda;          Wt_Line[38] := L3N3_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 70) AND (atm_num <= 95) THEN        BEGIN          eV_Line[39] := L3O2_Handle^^.Data[atm_num].Lamda;          Wt_Line[39] := L3O2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 89) AND (atm_num <= 95) THEN        BEGIN          eV_Line[40] := L3O3_Handle^^.Data[atm_num].Lamda;          Wt_Line[40] := L3O3_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 79) AND (atm_num <= 95) THEN        BEGIN          eV_Line[41] := L3P1_Handle^^.Data[atm_num].Lamda;          Wt_Line[41] := L3P1_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 63) AND (atm_num <= 95) THEN        BEGIN          eV_Line[44] := LB15_Handle^^.Data[atm_num].Lamda;          Wt_Line[44] := LB15_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 21) AND (atm_num <= 95) THEN        BEGIN          eV_Line[30] := LB17_Handle^^.Data[atm_num].Lamda;          Wt_Line[30] := LB17_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 62) AND (atm_num <= 95) THEN        BEGIN          eV_Line[47] := LB6_Handle^^.Data[atm_num].Lamda;          Wt_Line[47] := LB6_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 39) AND (atm_num <= 95) THEN        BEGIN          eV_Line[17] := LG11_Handle^^.Data[atm_num].Lamda;          Wt_Line[17] := LG11_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 49) AND (atm_num <= 95) THEN        BEGIN          eV_Line[19] := LG4_Handle^^.Data[atm_num].Lamda;          Wt_Line[19] := LG4_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 57) AND (atm_num <= 95) THEN        BEGIN          eV_Line[33] := LG6_Handle^^.Data[atm_num].Lamda;          Wt_Line[33] := LG6_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 37) AND (atm_num <= 95) THEN        BEGIN          eV_Line[34] := LG8_Handle^^.Data[atm_num].Lamda;          Wt_Line[34] := LG8_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 72) AND (atm_num <= 95) THEN        BEGIN          eV_Line[50] := Ls_Handle^^.Data[atm_num].Lamda;          Wt_Line[50] := Ls_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 70) AND (atm_num <= 95) THEN        BEGIN          eV_Line[51] := Lt_Handle^^.Data[atm_num].Lamda;          Wt_Line[51] := Lt_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 58) AND (atm_num <= 95) THEN        BEGIN          eV_Line[52] := Lu_Handle^^.Data[atm_num].Lamda;          Wt_Line[52] := Lu_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 58) AND (atm_num <= 95) THEN        BEGIN          eV_Line[36] := Lv_Handle^^.Data[atm_num].Lamda;          Wt_Line[36] := Lv_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 37) AND (atm_num <= 51) THEN        BEGIN          eV_Line[55] := M2M4_Handle^^.Data[atm_num].Lamda;          Wt_Line[55] := M2M4_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 37) AND (atm_num <= 44) THEN        BEGIN          eV_Line[59] := M3M4_Handle^^.Data[atm_num].Lamda;          Wt_Line[59] := M3M4_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 40) AND (atm_num <= 52) THEN        BEGIN          eV_Line[60] := M3M5_Handle^^.Data[atm_num].Lamda;          Wt_Line[60] := M3M5_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 68) AND (atm_num <= 95) THEN        BEGIN          eV_Line[62] := M3N4_Handle^^.Data[atm_num].Lamda;          Wt_Line[62] := M3N4_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 73) AND (atm_num <= 95) THEN        BEGIN          eV_Line[67] := M4N3_Handle^^.Data[atm_num].Lamda;          Wt_Line[67] := M4N3_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 40) AND (atm_num <= 95) THEN        BEGIN          eV_Line[68] := M4O2_Handle^^.Data[atm_num].Lamda;          Wt_Line[68] := M4O2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 48) AND (atm_num <= 82) THEN        BEGIN          eV_Line[71] := M5O3_Handle^^.Data[atm_num].Lamda;          Wt_Line[71] := M5O3_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 90) AND (atm_num <= 95) THEN        BEGIN          eV_Line[58] := M2O4_Handle^^.Data[atm_num].Lamda;          Wt_Line[58] := M2O4_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 68) AND (atm_num <= 95) THEN        BEGIN          eV_Line[75] := N4N6_Handle^^.Data[atm_num].Lamda;          Wt_Line[75] := N4N6_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 68) AND (atm_num <= 95) THEN        BEGIN          eV_Line[76] := N5N6_Handle^^.Data[atm_num].Lamda;          Wt_Line[76] := N5N6_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 72) AND (atm_num <= 95) THEN        BEGIN          eV_Line[20] := LG4p_Handle^^.Data[atm_num].Lamda;          Wt_Line[20] := LG4p_Handle^^.Data[atm_num].Weight;        END;      {본본본본본본본본본본본본본본본본본본본본본본본본본본본본본본본}      IF (atm_num >= 3) AND (atm_num <= 95) THEN        BEGIN          eV_Line[1] := KA1_Handle^^.Data[atm_num].Lamda;          eV_Line[2] := KA2_Handle^^.Data[atm_num].Lamda;          Wt_Line[1] := KA1_Handle^^.Data[atm_num].Weight;          Wt_Line[2] := KA2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 10) AND (atm_num <= 95) THEN        BEGIN          eV_Line[3] := KB1_Handle^^.Data[atm_num].Lamda;          Wt_Line[3] := KB1_Handle^^.Data[atm_num].Weight;          { Weight_KB1 adjusted for satellites and other betas at the bottom of procedure }        END;      IF (atm_num >= 28) AND (atm_num <= 95) THEN        BEGIN          eV_Line[4] := KB2_Handle^^.Data[atm_num].Lamda;          Wt_Line[4] := KB2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 13) AND (atm_num <= 95) THEN        BEGIN          eV_Line[5] := KB3_Handle^^.Data[atm_num].Lamda;          Wt_Line[5] := KB3_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 36) AND (atm_num <= 95) THEN        BEGIN          eV_Line[6] := KB4_Handle^^.Data[atm_num].Lamda;          Wt_Line[6] := KB4_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 19) AND (atm_num <= 95) THEN        BEGIN          eV_Line[7] := KB5_Handle^^.Data[atm_num].Lamda;          Wt_Line[7] := KB5_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 20) AND (atm_num <= 95) THEN        BEGIN          eV_Line[42] := LA1_Handle^^.Data[atm_num].Lamda;          eV_Line[43] := LA2_Handle^^.Data[atm_num].Lamda;          eV_Line[29] := LB1_Handle^^.Data[atm_num].Lamda;          Wt_Line[42] := LA1_Handle^^.Data[atm_num].Weight;          Wt_Line[43] := LA2_Handle^^.Data[atm_num].Weight;          Wt_Line[29] := LB1_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 39) AND (atm_num <= 95) THEN        BEGIN          eV_Line[45] := LB2_Handle^^.Data[atm_num].Lamda;          Wt_Line[45] := LB2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 21) AND (atm_num <= 95) THEN        BEGIN          eV_Line[14] := LB3_Handle^^.Data[atm_num].Lamda;          eV_Line[15] := LB4_Handle^^.Data[atm_num].Lamda;          Wt_Line[14] := LB3_Handle^^.Data[atm_num].Weight;          Wt_Line[15] := LB4_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 39) AND (atm_num <= 95) THEN        BEGIN          eV_Line[31] := LG1_Handle^^.Data[atm_num].Lamda;          Wt_Line[31] := LG1_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 31) AND (atm_num <= 95) THEN        BEGIN          eV_Line[18] := LG3_Handle^^.Data[atm_num].Lamda;          Wt_Line[18] := LG3_Handle^^.Data[atm_num].Weight;          eV_Line[144] := LG2_Handle^^.Data[atm_num].Lamda;          Wt_Line[144] := LG2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 16) AND (atm_num <= 95) THEN        BEGIN          eV_Line[49] := LL_Handle^^.Data[atm_num].Lamda;          Wt_Line[49] := LL_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 16) AND (atm_num <= 95) THEN        BEGIN          eV_Line[35] := Leta_Handle^^.Data[atm_num].Lamda;          Wt_Line[35] := Leta_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 21) AND (atm_num <= 95) THEN        BEGIN          eV_Line[32] := LG5_Handle^^.Data[atm_num].Lamda;          Wt_Line[32] := LG5_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 78) AND (atm_num <= 95) THEN        BEGIN          eV_Line[16] := LB9_Handle^^.Data[atm_num].Lamda;          Wt_Line[16] := LB9_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 37) AND (atm_num <= 95) THEN        BEGIN          eV_Line[48] := LB7_Handle^^.Data[atm_num].Lamda;          Wt_Line[48] := LB7_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 57) AND (atm_num <= 95) THEN        BEGIN          eV_Line[46] := LB5_Handle^^.Data[atm_num].Lamda;          Wt_Line[46] := LB5_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 46) AND (atm_num <= 95) THEN        BEGIN          eV_Line[13] := LB10_Handle^^.Data[atm_num].Lamda;          Wt_Line[13] := LB10_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 31) AND (atm_num <= 95) THEN        BEGIN          eV_Line[24] := L2N3_Handle^^.Data[atm_num].Lamda;          Wt_Line[24] := L2N3_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 67) AND (atm_num <= 95) THEN        BEGIN          eV_Line[12] := L1O4_Handle^^.Data[atm_num].Lamda;          Wt_Line[12] := L1O4_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 70) AND (atm_num <= 95) THEN        BEGIN          eV_Line[11] := L1O1_Handle^^.Data[atm_num].Lamda;          Wt_Line[11] := L1O1_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 73) AND (atm_num <= 95) THEN        BEGIN          eV_Line[63] := M3O1_Handle^^.Data[atm_num].Lamda;          Wt_Line[63] := M3O1_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 73) AND (atm_num <= 95) THEN        BEGIN          eV_Line[64] := M3O4_Handle^^.Data[atm_num].Lamda;          Wt_Line[64] := M3O4_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 73) AND (atm_num <= 95) THEN        BEGIN          eV_Line[65] := M3O5_Handle^^.Data[atm_num].Lamda;          Wt_Line[65] := M3O5_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 57) AND (atm_num <= 95) THEN        BEGIN          eV_Line[72] := MA1_Handle^^.Data[atm_num].Lamda;          Wt_Line[72] := MA1_Handle^^.Data[atm_num].Weight;          eV_Line[73] := MA2_Handle^^.Data[atm_num].Lamda;          Wt_Line[73] := MA2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 57) AND (atm_num <= 95) THEN        BEGIN          eV_Line[69] := MB_Handle^^.Data[atm_num].Lamda;          Wt_Line[69] := MB_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 41) AND (atm_num <= 95) THEN        BEGIN          eV_Line[66] := MG_Handle^^.Data[atm_num].Lamda;          Wt_Line[66] := MG_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 39) AND (atm_num <= 95) THEN        BEGIN          eV_Line[74] := MZ1_Handle^^.Data[atm_num].Lamda;          Wt_Line[74] := MZ1_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 39) AND (atm_num <= 95) THEN        BEGIN          eV_Line[70] := MZ2_Handle^^.Data[atm_num].Lamda;          Wt_Line[70] := MZ2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 41) AND (atm_num <= 95) THEN        BEGIN          eV_Line[57] := M2N4_Handle^^.Data[atm_num].Lamda;          Wt_Line[57] := M2N4_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 35) AND (atm_num <= 95) THEN        BEGIN          eV_Line[61] := M3N1_Handle^^.Data[atm_num].Lamda;          Wt_Line[61] := M3N1_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 35) AND (atm_num <= 95) THEN        BEGIN          eV_Line[56] := M2N1_Handle^^.Data[atm_num].Lamda;          Wt_Line[56] := M2N1_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 73) AND (atm_num <= 95) THEN        BEGIN          eV_Line[54] := M1N3_Handle^^.Data[atm_num].Lamda;          Wt_Line[54] := M1N3_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 83) AND (atm_num <= 95) THEN        BEGIN          eV_Line[53] := M1N2_Handle^^.Data[atm_num].Lamda;          Wt_Line[53] := M1N2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 68) AND (atm_num <= 95) THEN        BEGIN          eV_Line[75] := N4N6_Handle^^.Data[atm_num].Lamda;          Wt_Line[75] := N4N6_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 68) AND (atm_num <= 95) THEN        BEGIN          eV_Line[76] := N5N6_Handle^^.Data[atm_num].Lamda;          Wt_Line[76] := N5N6_Handle^^.Data[atm_num].Weight;        END;		      IF (atm_num >= 10) AND (atm_num <= 36) THEN        BEGIN          eV_Line[77] := SKA_Handle^^.Data[atm_num].Lamda;          Wt_Line[77] := SKA_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 11) AND (atm_num <= 38) THEN        BEGIN          eV_Line[78] := SKA3_Handle^^.Data[atm_num].Lamda;          Wt_Line[78] := SKA3_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 14) AND (atm_num <= 46) THEN        BEGIN          eV_Line[79] := SKA3p_Handle^^.Data[atm_num].Lamda;          Wt_Line[79] := SKA3p_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 16) AND (atm_num <= 28) THEN        BEGIN          eV_Line[80] := SKA3pp_Handle^^.Data[atm_num].Lamda;          Wt_Line[80] := SKA3pp_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 11) AND (atm_num <= 46) THEN        BEGIN          eV_Line[81] := SKA4_Handle^^.Data[atm_num].Lamda;          Wt_Line[81] := SKA4_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 11) AND (atm_num <= 16) THEN        BEGIN          eV_Line[82] := SKA5_Handle^^.Data[atm_num].Lamda;          Wt_Line[82] := SKA5_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 11) AND (atm_num <= 16) THEN        BEGIN          eV_Line[83] := SKA6_Handle^^.Data[atm_num].Lamda;          Wt_Line[83] := SKA6_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 11) AND (atm_num <= 17) THEN        BEGIN          eV_Line[84] := SKA7_Handle^^.Data[atm_num].Lamda;          Wt_Line[84] := SKA7_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 11) AND (atm_num <= 13) THEN        BEGIN          eV_Line[85] := SKA8_Handle^^.Data[atm_num].Lamda;          Wt_Line[85] := SKA8_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 11) AND (atm_num <= 12) THEN        BEGIN          eV_Line[86] := SKA9_Handle^^.Data[atm_num].Lamda;          Wt_Line[86] := SKA9_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 11) AND (atm_num <= 32) THEN        BEGIN          eV_Line[87] := SKAp_Handle^^.Data[atm_num].Lamda;          Wt_Line[87] := SKAp_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 14) AND (atm_num <= 29) THEN        BEGIN          eV_Line[88] := SKApp_Handle^^.Data[atm_num].Lamda;          Wt_Line[88] := SKApp_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 12) AND (atm_num <= 30) THEN        BEGIN          eV_Line[89] := SKB_Handle^^.Data[atm_num].Lamda;          Wt_Line[89] := SKB_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 29) AND (atm_num <= 32) THEN        BEGIN          eV_Line[90] := SKB10_Handle^^.Data[atm_num].Lamda;          Wt_Line[90] := SKB10_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 29) AND (atm_num <= 47) THEN        BEGIN          eV_Line[91] := SKB6_Handle^^.Data[atm_num].Lamda;          Wt_Line[91] := SKB6_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 28) AND (atm_num <= 51) THEN        BEGIN          eV_Line[92] := SKB7_Handle^^.Data[atm_num].Lamda;          Wt_Line[92] := SKB7_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 32) AND (atm_num <= 47) THEN        BEGIN          eV_Line[93] := SKB8_Handle^^.Data[atm_num].Lamda;          Wt_Line[93] := SKB8_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 31) AND (atm_num <= 47) THEN        BEGIN          eV_Line[94] := SKB9_Handle^^.Data[atm_num].Lamda;          Wt_Line[94] := SKB9_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 12) AND (atm_num <= 31) THEN        BEGIN          eV_Line[95] := SKBp_Handle^^.Data[atm_num].Lamda;          Wt_Line[95] := SKBp_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 15) AND (atm_num <= 44) THEN        BEGIN          eV_Line[96] := SKBpp_Handle^^.Data[atm_num].Lamda;          Wt_Line[96] := SKBpp_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 12) AND (atm_num <= 47) THEN        BEGIN          eV_Line[97] := SKBN_Handle^^.Data[atm_num].Lamda;          Wt_Line[97] := SKBN_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 11) AND (atm_num <= 17) THEN        BEGIN          eV_Line[98] := SKBX_Handle^^.Data[atm_num].Lamda;          Wt_Line[98] := SKBX_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 11) AND (atm_num <= 21) THEN        BEGIN          eV_Line[99] := SKBc4_Handle^^.Data[atm_num].Lamda;          Wt_Line[99] := SKBc4_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 12) AND (atm_num <= 20) THEN        BEGIN          eV_Line[100] := SKBc5_Handle^^.Data[atm_num].Lamda;          Wt_Line[100] := SKBc5_Handle^^.Data[atm_num].Weight;        END; (*     Weight_KB1 := Weight_KB1 - (Weight_KB2+Weight_KB3+Weight_KB4+Weight_KB5)   -(Weight_SKB+Weight_SKB10+Weight_SKB6+Weight_SKB7+Weight_SKB8+Weight_SKB9+     Weight_SKBp+Weight_SKBpp+Weight_SKBN+Weight_SKBX+Weight_SKBc4+Weight_SKBc5); *)      IF (atm_num >= 80) AND (atm_num <= 95) THEN        BEGIN          eV_Line[101] := SLA1cZ_Handle^^.Data[atm_num].Lamda;          Wt_Line[101] := SLA1cZ_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 42) AND (atm_num <= 48) THEN        BEGIN          eV_Line[102] := SLA2p_Handle^^.Data[atm_num].Lamda;          Wt_Line[102] := SLA2p_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 26) AND (atm_num <= 56) THEN        BEGIN          eV_Line[103] := SLA3_Handle^^.Data[atm_num].Lamda;          Wt_Line[103] := SLA3_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 62) AND (atm_num <= 80) THEN        BEGIN          eV_Line[104] := SLA3cZ_Handle^^.Data[atm_num].Lamda;          Wt_Line[104] := SLA3cZ_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 26) AND (atm_num <= 53) THEN        BEGIN          eV_Line[105] := SLA4_Handle^^.Data[atm_num].Lamda;          Wt_Line[105] := SLA4_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 27) AND (atm_num <= 56) THEN        BEGIN          eV_Line[106] := SLA5_Handle^^.Data[atm_num].Lamda;          Wt_Line[106] := SLA5_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 37) AND (atm_num <= 56) THEN        BEGIN          eV_Line[107] := SLA6_Handle^^.Data[atm_num].Lamda;          Wt_Line[107] := SLA6_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 37) AND (atm_num <= 56) THEN        BEGIN          eV_Line[108] := SLA7_Handle^^.Data[atm_num].Lamda;          Wt_Line[108] := SLA7_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 41) AND (atm_num <= 56) THEN        BEGIN          eV_Line[109] := SLA8_Handle^^.Data[atm_num].Lamda;          Wt_Line[109] := SLA8_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 42) AND (atm_num <= 56) THEN        BEGIN          eV_Line[110] := SLA9_Handle^^.Data[atm_num].Lamda;          Wt_Line[110] := SLA9_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 73) AND (atm_num <= 95) THEN        BEGIN          eV_Line[111] := SLAA_Handle^^.Data[atm_num].Lamda;          Wt_Line[111] := SLAA_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 66) AND (atm_num <= 95) THEN        BEGIN          eV_Line[112] := SLAp_Handle^^.Data[atm_num].Lamda;          Wt_Line[112] := SLAp_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 73) AND (atm_num <= 96) THEN        BEGIN          eV_Line[113] := SLAS_Handle^^.Data[atm_num].Lamda;          Wt_Line[113] := SLAS_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 75) AND (atm_num <= 95) THEN        BEGIN          eV_Line[114] := SLAcIX_Handle^^.Data[atm_num].Lamda;          Wt_Line[114] := SLAcIX_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 62) AND (atm_num <= 95) THEN        BEGIN          eV_Line[115] := SLAcX_Handle^^.Data[atm_num].Lamda;          Wt_Line[115] := SLAcX_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 73) AND (atm_num <= 82) THEN        BEGIN          eV_Line[116] := SLAcY_Handle^^.Data[atm_num].Lamda;          Wt_Line[116] := SLAcY_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 58) AND (atm_num <= 70) THEN        BEGIN          eV_Line[128] := SLB14_Handle^^.Data[atm_num].Lamda;          Wt_Line[128] := SLB14_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 26) AND (atm_num <= 50) THEN        BEGIN          eV_Line[129] := SLB1pp_Handle^^.Data[atm_num].Lamda;          Wt_Line[129] := SLB1pp_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 42) AND (atm_num <= 48) THEN        BEGIN          eV_Line[130] := SLB1c4_Handle^^.Data[atm_num].Lamda;          Wt_Line[130] := SLB1c4_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 40) AND (atm_num <= 95) THEN        BEGIN          eV_Line[117] := SLB2c1_Handle^^.Data[atm_num].Lamda;          Wt_Line[117] := SLB2c1_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 40) AND (atm_num <= 95) THEN        BEGIN          eV_Line[118] := SLB2c2_Handle^^.Data[atm_num].Lamda;          Wt_Line[118] := SLB2c2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 73) AND (atm_num <= 95) THEN        BEGIN          eV_Line[119] := SLB2c3_Handle^^.Data[atm_num].Lamda;          Wt_Line[119] := SLB2c3_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 74) AND (atm_num <= 95) THEN        BEGIN          eV_Line[120] := SLB2c4_Handle^^.Data[atm_num].Lamda;          Wt_Line[120] := SLB2c4_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 75) AND (atm_num <= 95) THEN        BEGIN          eV_Line[121] := SLB2c5_Handle^^.Data[atm_num].Lamda;          Wt_Line[121] := SLB2c5_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 75) AND (atm_num <= 95) THEN        BEGIN          eV_Line[122] := SLB2c7_Handle^^.Data[atm_num].Lamda;          Wt_Line[122] := SLB2c7_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 44) AND (atm_num <= 60) THEN        BEGIN          eV_Line[123] := SLB2cA_Handle^^.Data[atm_num].Lamda;          Wt_Line[123] := SLB2cA_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 40) AND (atm_num <= 56) THEN        BEGIN          eV_Line[124] := SLB2cB_Handle^^.Data[atm_num].Lamda;          Wt_Line[124] := SLB2cB_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 42) AND (atm_num <= 50) THEN        BEGIN          eV_Line[125] := SLB2cC_Handle^^.Data[atm_num].Lamda;          Wt_Line[125] := SLB2cC_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 77) AND (atm_num <= 88) THEN        BEGIN          eV_Line[126] := SLB5c1_Handle^^.Data[atm_num].Lamda;          Wt_Line[126] := SLB5c1_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 76) AND (atm_num <= 88) THEN        BEGIN          eV_Line[127] := SLB5c2_Handle^^.Data[atm_num].Lamda;          Wt_Line[127] := SLB5c2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 55) AND (atm_num <= 62) THEN        BEGIN          eV_Line[131] := SLG10_Handle^^.Data[atm_num].Lamda;          Wt_Line[131] := SLG10_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 41) AND (atm_num <= 83) THEN        BEGIN          eV_Line[132] := SLG1p_Handle^^.Data[atm_num].Lamda;          Wt_Line[132] := SLG1p_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 40) AND (atm_num <= 83) THEN        BEGIN          eV_Line[133] := SLG2p_Handle^^.Data[atm_num].Lamda;          Wt_Line[133] := SLG2p_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 73) AND (atm_num <= 82) THEN        BEGIN          eV_Line[134] := SLG2pp_Handle^^.Data[atm_num].Lamda;          Wt_Line[134] := SLG2pp_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 58) AND (atm_num <= 70) THEN        BEGIN          eV_Line[135] := SLG9_Handle^^.Data[atm_num].Lamda;          Wt_Line[135] := SLG9_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 71) AND (atm_num <= 95) THEN        BEGIN          eV_Line[136] := SMAc1_Handle^^.Data[atm_num].Lamda;          Wt_Line[136] := SMAc1_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 71) AND (atm_num <= 95) THEN        BEGIN          eV_Line[137] := SMAc2_Handle^^.Data[atm_num].Lamda;          Wt_Line[137] := SMAc2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 79) AND (atm_num <= 83) THEN        BEGIN          eV_Line[138] := SMAc3_Handle^^.Data[atm_num].Lamda;          Wt_Line[138] := SMAc3_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 70) AND (atm_num <= 95) THEN        BEGIN          eV_Line[139] := SMAc4_Handle^^.Data[atm_num].Lamda;          Wt_Line[139] := SMAc4_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 72) AND (atm_num <= 95) THEN        BEGIN          eV_Line[140] := SMB1_Handle^^.Data[atm_num].Lamda;          Wt_Line[140] := SMB1_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 64) AND (atm_num <= 95) THEN        BEGIN          eV_Line[141] := SMB2_Handle^^.Data[atm_num].Lamda;          Wt_Line[141] := SMB2_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 70) AND (atm_num <= 95) THEN        BEGIN          eV_Line[142] := SMB3_Handle^^.Data[atm_num].Lamda;          Wt_Line[142] := SMB3_Handle^^.Data[atm_num].Weight;        END;      IF (atm_num >= 81) AND (atm_num <= 95) THEN        BEGIN          eV_Line[143] := SMGp_Handle^^.Data[atm_num].Lamda;          Wt_Line[143] := SMGp_Handle^^.Data[atm_num].Weight;        END;	 {changed 7/93...}      IF {(Calibrate_Energy_Scale) AND} (NOT Xray_Data_Request) THEN Calibrate_Energies;    END; { Procedure Get_Energies }END.