 {[j=30/55,:+,u+,r+,o=120,k+,n+,#+,v+,q+,b+,d-]}{[f-]} {*********************************} UNIT Declarations ; {*********************************} {************************************} INTERFACE {*********************************}USES QuickDraw, QuickdrawText, {CMApplication,}  Types, OSUtils, Events, ToolUtils, Timer, Errors, Menus, Files, Lists, Memory, Windows, Controls,  Packages, Printing, StandardFile, Serial, Fonts, Resources, fenv, fp, ColorPicker, PasLibIntf, SegLoad, TextEdit, Dialogs, TextUtils, Finder, Retrace, Spectrum_Structures;  {[f+]}   CONST     sysEnvironsVersion            = 1;    _WaitNextEvent                = $A860;    _Unimplemented                = $A89F;   { OSEvent                       = app4Evt;}          { event used by the multifinder }    resumeMask                    = 1;    Read_In                       = 0;    Write_Out                     = 1;    Expert_Mode                   = 13;    Black_Back_Ground             = 0;    White_Back_Ground             = 1;    Grey_Back_Ground              = 2;     maxatno                       = 95;               {set for 103 elements search for maxatno if changed}    FlatHandCursor                = 132;    ArrowCursor                   = 139;    MaxLabels                     = 130;               { the size of either of these two does not affect the }	    Max_Spec                      = 100;	Max_Line_Peaks				  = 130;    Max_ROIs                      = 100;               { size of the global data area }	gPRResType = 'POPT';		(* POPT = Print OPTions.  This type can be anything	*)								(* but to avoid confusion with Printing Manager		*)								(* resources, the following types should NOT be		*)								(* used: PREC, PDEF, & POST...						*)	gPRResID = 128;				(* This can also be any value.  Since there should	*)								(* only be one print record per document, the ID is	*)								(* a constant.										*)	gPRResName = 'Print Record';	(* Resource name.								*)  TYPE    NAME                          = STRING[63];    glnarray                      = ARRAY [1..5] OF real; { Used in the numerical integrations }    DataCommInfo                  =                   { the options available}      RECORD        portIn                        : Integer;      { -6 for modem, -8 for printer}        portOut                       : Integer;      { -7 for modem, -9 for printer}        baudRate                      : Integer;      { 300, 1200, 2400, 4800, 9600, 19200}        dataBits                      : Integer;      { 7 or 8}        stopBits                      : Integer;      { always stop10}        parity                        : Integer;      { none, even, or odd}        usingAsync                    : Boolean;      { true if using async i/o}      END;  TYPE    Sili_Rec                      =      RECORD        Detector                      : Detector_Rec; { spectroscopy, the xtal or chip or mode }        Azimuth                       : real;         { degrees }        Elevation                     : real;         { degrees }        Detector_Area                 : real;         { cm sq }        Detector_Thickness            : real;         { mm }        C_Thickness                   : real;         { um }        Diamond                       : real;         { um }        Mylar                         : real;         { um }        BN_Thickness                  : real;         { um }        SiN_Thickness                 : real;         { um }        Ice_Thickness                 : real;         { um, as pure oxygen }        Au_Thickness                  : real;         { um }        Al_Thickness                  : real;         { um }        Be_Thickness                  : real;         { um }        Si_Thickness                  : real;         { um }        Moxtek                        : real;         { Beta - changed to um Moxtek on 11/22/96}        Paralene                      : real;		  {	um Paralene on 11/22/96}        WDS_Resolution                : real;         { }        dE                            : real;        Si_Resolution                 : real;         { eV at Mn K alpha }        Energy_Intercept              : real;         { y intercept in eV }        Energy_Slope                  : real;         { }        Number_of_Channels            : Integer;        kV                            : real;        Detector_Tilt                 : real;         { Beta }        Quantum                       : real;        Spec_detector_Distance        : real;        y_tilt                        : real;        x_tilt                        : real;        Take_off_angle                : real;      END;    SiLi_RecPtr                   = ^Sili_Rec;    SiLi_RecHdl                   = ^SiLi_RecPtr;    VAR    theBGRec                      : SiLi_RecHdl;     theGenRec                     : SiLi_RecHdl;{ the actual stuff which belongs to }                                                 { the active response curve. }  TYPE    ROI_Data_Structure            =      RECORD        Lo                            : Integer;        Hi                            : Integer;        ROI                           : Integer;        value                         : real;        Exists                        : Boolean      END;  TYPE    ROIs                          =      RECORD        Peak                          : ARRAY [1..Max_ROIs] OF ROI_Data_Structure;        BackGround                    : ARRAY [1..Max_ROIs] OF ROI_Data_Structure;        Scale                         : ROI_Data_Structure;        Quant                         : ROI_Data_Structure;      END;    ROIPtr                        = ^ROIs;    ROIHndl                       = ^ROIPtr;  VAR    ROI                           : ROIHndl;  TYPE    Label_Data_Structure          =      RECORD        Box                           : Rect;        Channel                       : Integer;        ShiftedChannel                : Integer;        V_Scale_Top                   : real;        V_Scale_Bottom                : real;        XCenter                       : Integer;        YCenter                       : Integer;        Element                       : STRING[2];        Family                        : STRING[4];    { K,L,M, M2N4 etc.}        Greek                         : STRING[4];    { 'alpha'1,2 etc}        Exists                        : Boolean;        Active                        : Boolean;      END;    TYPE    Labels                        =      RECORD        S                             : ARRAY [0..MaxLabels] OF Label_Data_Structure;        Box                           : Rect;        XCenter                       : Integer;        YCenter                       : Integer;        Exists                        : Boolean;        Active                        : Boolean;        L                             : Str255;      END;    LabelPtr                      = ^Labels;    LabelHndl                     = ^LabelPtr;  VAR    Lab                           : LabelHndl;TYPE		Qual_record		=		RECORD								Spec_Nam	: string[32];								Peak_Max	: array [1..Max_Line_Peaks] of string[12];			END;		Qual_record_ptr =		^Qual_record;{ The following block is stuff for the linear least squares and Simplex procedures.  Peak ROIS are used to select the windows to do. }  TYPE    References_Rec                =      RECORD        Data                          : realWindowArray;        area                          : real;        dE                            : real;        kV                            : real;        Intercept                     : real;         { deactivated for now }        Slope                         : real;         { deactivated for now }        FWHM_Mn                       : real;        Atomic_Number                 : Integer;        Family                        : STRING[1];        Begin_Energy                  : real;         { in eV }        End_Energy                    : real;         { in eV }        source                        : fnamestr;     {63 chars}        Datemade                      : longint;        spec_num                      : Integer;        LoE_Line                      : real;        HiE_Line                      : real;        generated                     : Boolean;        Bkg_Subtd                     : Boolean;        sparestr                      : STRING[174];        Comments                      : STR255;      END;    RefPtr                        = ^References_Rec;    RefS                          = ^RefPtr;  VAR    Reference                     : ARRAY [1..Max_Num_References] OF RefS;    ZeroWindow                    : WindowArrayHdl;    Win                           : ARRAY [1..3] OF WindowArrayHdl;    Weight, Ydata                 : WindowArrayHdl;   { handles to extendeds}    XData                         : WindowHdlArray;   { double_t }  TYPE    WtngInfo                      =      RECORD        Master                        : Integer;        Wt                            : real;		sign						  : integer;      END;  TYPE    Fit_Record                    =      RECORD        Gaussians                     : realWindowArray;        Residuals                     : realWindowArray;        FittedBkg                     : realWindowArray;      END;    FitPtr                        = ^Fit_Record;    FitHdl                        = ^FitPtr;  VAR    FitS                          : FitHdl;  TYPE    Str_2                         = STRING[2];    Str_4                         = STRING[4];    Str_5                         = STRING[5];    Str_50                        = STRING[50];    str_25						  = STRING[25];  TYPE    Fit_Params_Type               =      RECORD        Fit_Procedure                 : STRING[2];        Ref_FileName                  : ARRAY [1..5] OF fnamestr;        Toler                         : real;        DEN                           : real;        DFWHMM                        : real;        switch                        : real;        FWStart                       : real;        Chosen_ROI_Lo                 : real;        Chosen_ROI_Hi                 : real;        Number_of_Windows             : Integer;        Number_of_Peaks               : Integer;      { # in all windows }        First_in_Roi                  : ARRAY [1..MaxNumPks] OF Integer;        Fitting_Roi_Lo                : ARRAY [1..MaxNumPks] OF real;	{in eV}        Fitting_Roi_Hi                : ARRAY [1..MaxNumPks] OF real;        Atomic_Number                 : ARRAY [1..MaxNumPks] OF Integer;        Siegbahn                      : ARRAY [1..MaxNumPks] OF Str_5;        ev_LoLine 	                  : ARRAY [1..MaxNumPks] OF real;	{book energy}        ev_HiLine                     : ARRAY [1..MaxNumPks] OF real;	{book energy}        Ref_Index                     : ARRAY [1..MaxNumPks] OF Integer;        constrained                   : Boolean;        Other_stuff                   : ARRAY [1..20] OF Integer;      END;    Fit_Result_Type               =      RECORD        Iterations                    : ARRAY [1..MaxNumPks] OF Integer;        Response                      : ARRAY [1..MaxNumPks] OF real;        FWHM_Mn                       : ARRAY [1..MaxNumPks] OF real;        area                          : ARRAY [1..MaxNumPks] OF real;        Err_or_Energy                 : ARRAY [1..MaxNumPks] OF real;        Peak_to_Local_Bkg             : ARRAY [1..MaxNumPks] OF real;        Peak_to_Chosen_Bkg            : ARRAY [1..MaxNumPks] OF real;        conc                          : ARRAY [1..MaxNumPks] OF real;        Chosen_Norm_Bkg               : real;      END;    Simplex_Fit                   =      RECORD        ExptStuff                     : Expt_InfoRec;        SpectrumStuff                 : Spectrum_Structure;        Fit_Params                    : Fit_Params_Type;        Fit_Result                    : Fit_Result_Type;      END;    SimPtr                        = ^Simplex_Fit;    SimpS                         = ^SimPtr;  VAR    Analysis_Result               : SimpS;    DoFirst, DoSecond             : ARRAY [1..MaxNumPks] OF Boolean; { for each reference in ML FIT}  TYPE    Geometry                      =      RECORD        Beam_Entry_Angle              : real;        Beta_Angle                    : real;        Spec_Det_Dist                 : real;        Elevation_Angle               : real;        Azimuthal_Angle               : real;        X_Tilt_Angle                  : real;        Y_Tilt_Angle                  : real;        Angle_of_TakeOff              : real;      END;  TYPE    DocumentRecord                =      RECORD        Window                        : WindowRecord;        te                            : TEHandle;      END;    DocumentPeek                  = ^DocumentRecord;    (*VBLTaskPtr                    = ^VBLTask;     dtTaskPtr                     = ^DeferredTask;*)  (* comment out this record for MPW Pascal, use it for TML...... *)  (* DeferredTask                  =      RECORD        qLink                         : QElemPtr;        qType                         : Integer;        dtFlags                       : Integer;        dtAddr                        : ProcPtr;        dtparm                        : longint;        dtReserved                    : longint;      END; *)  TYPE    D_Array                       = ARRAY [1..4] OF real;  TYPE    Deriv_Info                    =      RECORD                                          { used to store info about derivatives to use }        Z                             : Integer;        Family                        : STRING[1]     {Family_Type} ;        use1st                        : Boolean;        use2nd                        : Boolean;      END;	      ML_Stuff                      =      RECORD        number_of_files               : Integer;        The_File_Name                 : ARRAY [1..5] OF fnamestr;        refindex                      : NPKARRAY;        number_of_MLwindows           : Integer;        number_of_refs                : Integer;        ML_LoeV                       : PKARRAY;	{calibrated window energies}        ML_HieV                       : PKARRAY;        number_of_derivs              : Integer;        window_element                : NPKARRAY;        weFamily                      : ARRAY [1..MaxNumPks] OF STRING[1] {Family_Type} ;        Number_of_refs_in_Window      : NPKARRAY;        number_of_derivs_Window       : NPKARRAY;        First_Ref                     : NPKARRAY;        Last_ref                      : NPKARRAY;        First_Deriv                   : NPKARRAY;        Last_deriv                    : NPKARRAY;        DoFirst                       : ARRAY [1..MaxNumPks] OF Boolean;        DoSecond                      : ARRAY [1..MaxNumPks] OF Boolean;        BkgLo                         : real;        BkgHi                         : real;        BkgArea                       : real;      END;    Ml_Stuff_Ptr                  = ^ML_Stuff;    ML_Stuff_Hdl                  = ^Ml_Stuff_Ptr;    VAR    ML_Setup                      : ML_Stuff_Hdl;TYPE    Array_Stuff                      =      RECORD		Peak_Info_Width               : ARRAY [1..10] OF Integer; {window constants, see proto init}		Peak_Info_Amplitude           : ARRAY [1..10] OF Integer;		Peak_Info_Energy              : ARRAY [1..10] OF Integer;		Plt_Syms_S                    : ARRAY [1..10] OF Integer;		Plot_Symbol                   : ARRAY [1..10] OF Integer;		Plot_Color                    : ARRAY [1..10] OF Integer;		Plot_Connected                : ARRAY [1..10] OF Integer;		Thin_At_Num                   : ARRAY [1..15] OF Integer;		Bulk_At_Num                   : ARRAY [1..15] OF Integer;		ElementZ                      : ARRAY [1..MaxNumPks] OF Integer;		C_Full                        : ARRAY [1..10] OF Integer;		S_to_Work                     : ARRAY [1..10] OF Integer;		Work_to_S                     : ARRAY [1..10] OF Integer;		Copy_S_to_Work                : ARRAY [1..10] OF Integer;		Copy_Work_to_S                : ARRAY [1..10] OF Integer;		IZ                            : ARRAY [1..20] OF Integer; { atomic number, citzaf}		Marker                        : ARRAY [1..5] OF real;		Edge                          : ARRAY [1..17] OF real;		GR                            : ARRAY [1..20] OF real;    { Gravimetric factor, citzaf}		Bulk_Concentration            : ARRAY [1..15] OF real;		Thin_Concentration            : ARRAY [1..15] OF real;		DataMaxS                      : ARRAY [1..10] OF real;		DataMinS                      : ARRAY [1..10] OF real;		ElementSymbolList             : ARRAY [0..maxatno] OF STRING[2];		Sym                           : ARRAY [0..maxatno] OF STRING[2];		Spectrum_Class_Holding_String : ARRAY [1..13] OF str_25;		Thin_Valence                 : ARRAY [0..15] OF longint;		Bulk_Valence                 : ARRAY [0..15] OF longint;      END;    Array_Stuff_Ptr                  = ^Array_Stuff;     VAR    A                       : Array_Stuff_Ptr;  TYPE       glsarray  =  array[1..600] of real; { Numerical Recipe's stuff for BG correct unit }      NumRecp_Ptr   = ^glsarray;  VAR	  xxx,yyy,arr : NumRecp_Ptr;	  	  {This is for the compositional database}TYPE	Comp_Rec				=	RECORD								C_Name		:	string[32];								C_Number	:	integer;								C_Density	:	real;								C_Atno		:	Array [1..15] of integer;								C_WtFr		:	Array [1..15] of real;								C_Valence	:	Array [1..15] of integer;								C_Code		:	longint;								C_Thick		:	real;								C_spareI	:	integer;	END;		Comp_RecPtr			=	^Comp_Rec;	Comp_RecHdl			=	^Comp_RecPtr;VAR	Comp_Data					  :	array [1..50] of Comp_RecHdl;	Number_of_Entries			  :	longint;  TYPE    ZAF_Stuff                     =      RECORD        Simplex_run                   : Boolean;                { all spectra - one of these two must be 1 }        ML_run                        : Boolean;                { all spectra }        standard                      : Boolean;                { if spectrum is a standard this is 1 }        Stoic_Diff                    : Boolean;                { 0 for element by difference or 1 if by stoic. }        Num_elements                  : Integer;                { number of elements in specimen }        Atomic_Number                 : ARRAY [1..15] OF Integer; { for each element in specimen }        Atom_Wt                       : ARRAY [1..15] OF real;  { for each element in specimen }        Valence                       : ARRAY [1..15] OF real;  { for each element in specimen }        Siegbahn                      : ARRAY [1..15] OF Str_5; { x-ray line for quant. of each element }        Std_Name                      : ARRAY [1..15] OF STRING[64];                                                                { for specimen - name of standard used to quant. each element }        Pure_Standard_Intensity       : ARRAY [1..15] OF real;  { for standard - peak area }        Concentration                 : ARRAY [1..15] OF real;                                                                { if std then wt.fr. of element. if unknown then quant. results }        K_kRatio                      : ARRAY [1..15] OF real;                                                                { k ratio for a K line - unknown. if std then this is std factor }        L_kRatio                      : ARRAY [1..15] OF real;                                                                { k ratio for a L line - unknown. if std then this is std factor }        M_kRatio                      : ARRAY [1..15] OF real;                                                                { k ratio for a M line - unknown. if std then this is std factor }        Peak_to_Bkg                   : ARRAY [1..15] OF real;  { peak to background ratio - used for particles }        ChiSqr                        : ARRAY [1..15] OF real;  { chi squared from fitting }        Err_Energy                    : ARRAY [1..15] OF real;  { LS - fitting error. Simplex - peak energy }        spare1                        : ARRAY [1..15] OF Integer;        RawArea                       : ARRAY [1..15] OF real;  {cit}        Unanal_Z_On                   : Boolean;        Fixed_Conc                    : ARRAY [1..15] OF Boolean;        Normalize_On                  : Boolean;        bspare3                       : Boolean;        bspare4                       : Boolean;      END;    ZAFPtr                        = ^ZAF_Stuff;    ZAFHdl                        = ^ZAFPtr;		Quant_stds_info					  =	  RECORD	  	Num_Std_Elems				  : ARRAY [1..15] OF integer;  { number of elements in the standard }		Z_of_Std_Elems				  : ARRAY [1..15,1..15] OF integer;  { atomic numbers of elements in standard }		C_of_Std_Elems				  : ARRAY [1..15,1..15] OF real;  { concentrations of of elements in standard }	  END;    ZAF_full                      =      RECORD        Standard_Name                 : Str255;       { if a standard then this is std name }        SpectrumType                  : STRING[4];    { EDS, WDS, EELS, etc. }        E0                            : real;         { beam voltage in kV }        Take_off_angle                : real;         { take off angle }        Instrument                    : real;         { instrument - probably detectorID }        Faraday_Current               : real;         { beam current nA }        Live_Time                     : real;         { counting time for spectrum }        Num_Fit_Peaks                 : Integer;        Spare2                        : real;        Spare3                        : real;        KFJH_Active                   : Boolean;        bspare2                       : Boolean;        bspare3                       : Boolean;        bspare4                       : Boolean;        ZAF_data                      : ZAF_Stuff;		Quant_stds					  : Quant_stds_info;      END;    ZAF_fullPtr                   = ^ZAF_full;    ZAF_fullHdl                   = ^ZAF_fullPtr;    VAR    { ZAF_Setup : ZAFHdl; }    ZAF_Record                    : ZAF_fullHdl;    ZAF_standard                  : ARRAY [1..30] OF ZAF_fullHdl;    ZAF_Str                       : STRING[4];    Quant_Work                    : Boolean;	ZAF_Quant                     : Boolean; 	local                         : Boolean; 	read_file                     : Boolean;    stds_found                    : Integer;    stds_picked                   : ARRAY [1..30] OF Integer;    TEh_Display_Num               : TEHandle;    DisplayNumRect                : Rect;    ZAF_Direction                 : Integer;    index_g                       : Integer;	num_std_structures            : integer;		{본볈ake global 5/21/95본볗  TYPE    widpt                         = Point;    widptr                        = ^widpt;    widhdl                        = ^widptr;  VAR    xWidth                        : widhdl;    Use_ZAFsetup_file             : Boolean;    Std_File_name                 : fnamestr;	Cl_Valid_Peak	: integer;	{this global exists only to pick up Valid_peak								 from Thin_Film in Physics. When the sorting								 routine is made into a global fnc we can throw it away.}  TYPE    Hall_Stuff                    =      RECORD        do_bulk                       : Boolean;        get_film                      : Boolean;        get_grid                      : Boolean;        get_stds                      : Boolean;        Bulk_Z                        : Integer;        Bulk_Line                     : Str_5;        FilmCorr                      : real;        Bulk_Factor                   : real;        Average_Z                     : real;        FilmFile                      : fnamestr;        BulkFile                      : fnamestr;        Number_of_Peaks               : Integer;        Atomic_Number                 : ARRAY [1..MaxNumPks] OF Integer; { which peaks to quantitate }        Siegbahn                      : ARRAY [1..MaxNumPks] OF Str_5;		ev_LoLine					  : ARRAY [1..MaxNumPks] OF real;{book energy}		ev_HiLine					  : ARRAY [1..MaxNumPks] OF real;{book energy}        K_Factor                      : ARRAY [1..MaxNumPks] OF real;        Std_File_Code                 : ARRAY [1..MaxNumPks] OF Integer;        Standard_files                : ARRAY [1..5] OF fnamestr;      END;    HallPtr                       = ^Hall_Stuff;    HallHdl                       = ^HallPtr;         Hall_OutStuff                 =      RECORD        do_ML                         : Boolean;		resultsname                   : String[57];		ResultsDirId				  : Longint;		ResultsVNum 				  : integer;        DTSAname                      : str_25;        class                         : str_25;        spectnum                      : Integer;        Z_Corr                        : real;         { Calculated avg Z }        BulkBk                        : real;         { bkg contribution from bulk source }        Totbk                         : real;         { bkg corrected for film and bulk contributions }        conc                          : ARRAY [1..MaxNumPks] OF real;        ptob                          : ARRAY [1..MaxNumPks] OF real;        stdev                         : ARRAY [1..MaxNumPks] OF real;      END;    HallOutPtr                    = ^Hall_OutStuff;    HallOutHdl                    = ^HallOutPtr;		CL_BaseStuff =	{the CL_BaseStuff and CL_LineStuff are always around & are setup stuff}		RECORD			Kfitproc	: string[2];			Kkv			: real;	  		KDetector	: Detector_Rec;            K_files      	: ARRAY [1..10] OF fnamestr;			number_of_peaks	: integer;	{number of k factors}		    Base_Z			: integer;			Base_Line		: STRING[1];			base_loev	:	real; 			base_hiev	:	real; 			base_roi_lo	:	real;			base_roi_hi	:	real;			Report_oxides	: boolean;			Ox_by_Stoic		: boolean;			relative_error	:	real;        END;	ClBsPtr = ^CL_BaseStuff;	ClBsHdl = ^ClBsPtr;	CL_LineStuff =		RECORD			line		: string[1];			Z_number	: integer;			KFactor		: real;			evloLine	: real;			evhiLine	: real;			evloRoi		: real;			evhiRoi		: real;			fileIndex	: integer;        END;	ClPtr = ^CL_LineStuff;	ClHdl = ^ClPtr;		Cl_OutStuff = 			RECORD		    BaseInfo    : CL_BaseStuff;			LineInfo    : ARRAY [1..MaxNumPks-1] OF CL_LineStuff;{10/14/94}			SpecID      : String[19]; {took away 1 LineInfo (26 bytes) for next 2 fields}			ResultsVNum : integer;			ResultsName : String[57];	{originally there was a fnamestr somewhere}			ResultsDirID: Longint;			DTSAname	: String[25];			spectnum	: integer;			Class		: String[25];			area		: ARRAY [1..MaxNumPks] OF real;            conc        : ARRAY [1..MaxNumPks] OF real;			stdev		: ARRAY [1..MaxNumPks] OF real;			thickness	: ARRAY [1..MaxNumPks] OF real;			valence		: ARRAY [1..MaxNumPks] OF real;		END;	CLOutPtr = ^Cl_OutStuff;	CLOutHdl = ^ClOutPtr;	Calib_Record					=		RECORD			Energy_Intercept          : real;         { y intercept in eV }			Energy_Slope              : real;         { }		END;	X_Sect_Lab = 			RECORD		    Thin_X_Xec_List				  : ARRAY [1..51] of STRING[23];		    Bulk_X_Xec_List				  : ARRAY [1..51] of STRING[23];		END;	X_SectPtr = ^X_Sect_Lab;	X_SectHdl = ^X_SectPtr;		VAR		X_SectRec 	: X_SectHdl;		TYPE	Q_Calib_Rec		=	  RECORD	  	Q_AtNum				: ARRAY [1..2] OF INTEGER;	  	Q_Line				: ARRAY [1..2] OF STRING[5];	  	Q_MeasE				: ARRAY [1..2] OF REAL;	  	Q_BookE				: ARRAY [1..2] OF REAL;	  	Q_Slope				: REAL;	  	Q_Intercept			: REAL;	  END;		Q_EBeam_Rec		=	  RECORD	  	Q_ApproxE			: REAL;	  	Q_FinalE			: REAL;	  	Q_Error				: REAL;	  END;	  	Q_Simplx_Rec	=	  RECORD	  	Q_NumROIs			: INTEGER;	  	Q_NumPeaks			: INTEGER;	  	Q_NumElements		: INTEGER;	  	Q_Z_Peak			: ARRAY [1..50] OF INTEGER;	  	Q_Li_Peak			: ARRAY [1..50] OF STRING[5];	  	Q_Area				: ARRAY [1..50] OF REAL;	  	Q_FWHM				: ARRAY [1..50] OF REAL;	  	Q_Mn_FWHM			: ARRAY [1..50] OF REAL;	  	Q_Energy			: ARRAY [1..50] OF REAL;	  	Q_ROI				: ARRAY [1..50] OF ROI_Data_Structure;	  	Q_First_in_ROI		: ARRAY [1..10] OF INTEGER;	  	Q_WtngInfo			: ARRAY [1..50] OF WtngInfo;	  	Q_PktoBG			: ARRAY [1..50] OF REAL;	  	Q_Tolerance			: REAL;	  	Q_Stop				: INTEGER;	  END;	  	QC_Record			=	  RECORD	  	Q_Comments			: Str255;	  	Q_Date				: STRING[16];	  	Q_Current			: REAL;	  	Q_Time				: REAL;	  	Q_SprdSht_Spec		: FSSpec;	  	Q_Cal_Info			: Q_Calib_Rec;	  	Q_EBm_Info			: Q_EBeam_Rec;	  	Q_Simpx_Info		: Q_Simplx_Rec;	  	Q_SEM				: boolean;	  END;	     QC_Ptr			= ^QC_Record;   QC_Hdl			= ^QC_Ptr;VAR   QC_Rec			: QC_Hdl;  VAR		Cal_vals					  : Calib_Record;    Scratch                       : TEHandle;         {Used to dump unwanted key presses}    theInput                      : TEHandle;         {Used in text edit selections for all windows}    Plain                         : text;    { File Variable in Curve Fit output }    Spread                        : text;    { File Variable in Curve Fit output }(*  StatView                      : text;    { File Variable in Curve Fit output }    Exel                          : text;    { File Variable in Curve Fit output }    Kaleid                        : text;    { File Variable in Curve Fit output }*)  MCA_Binary                    : text;    { File Variable in Curve Fit output }    Physics_File                  : text;    { File Variable in Curve Fit output }(*  These are the grouped needs, nicely together for reference    KaleidName                    : fnamestr;    Kaleid                        : text;             	Kaleid_Boolean                : Boolean;	Kal_VolNum                    : integer;    ExelName                      : fnamestr;    Exel                          : text;             	Exel_Boolean                  : Boolean;	Exel_volnum                   : integer;    PlainName                     : fnamestr;	Plain_VolNum                  : integer;    Plain                         : text;             	Plain_Boolean                 : Boolean;	    StatViewName                  : fnamestr;    StatView                      : text;             	StatView_Boolean              : Boolean;	Stat_VolNum                   : integer;*)	    ch                            : Char;             {Key pressed in Ascii}    Last_Label_Element            : Str_2;    Last_Label_Family             : Str_4;    str_info                      : STRING[3];    Hall_Str                      : STRING[4];    Peak_temp                     : STRING[5];        {Get text entered, temp holding}    HeaderTemp                    : STRING[5];        {Get text entered, temp holding}    Marker_Input_text             : STR255;           {Get text entered for the markers}	x_label						  : array [1..2] OF STRING[5];    myprompt                      : Str255;    Old_Label                     : Str255;    Old_LeftHoriz                 : Str255;    Old_RightHoriz                : Str255;    Old_UpperVert                 : Str255;    Old_LowerVert                 : Str255;    Save_Volume_Name              : StringPtr;		{Make sure these are assigned memory with newPtr!}    volName                       : StringPtr;		{See Initilize.p, assignmemory}    Default_Volume_Name           : StringPtr;    Binary_Volume_Name            : StringPtr;    PrefFileName                  : NAME;    OutFile                       : NAME;    FX                            : NAME;    FJ                            : NAME;		In_Spec				  		  : FSSpec;			{본New DTSA file spec본}	Out_Spec				  	  : FSSpec;			{본New DTSA file spec본}	Read_DTSA_Spec				  : FSSpec;			{본New DTSA file spec본}	Write_DTSA_Spec				  : FSSpec;			{본New DTSA file spec본}	RefSpec						  : FSSpec;			{본New DTSA file spec본}	MCAResult_Spec				  : FSSpec;			{본New DTSA file spec본}	SpreadSpec					  : FSSpec;			{본New DTSA file spec본}	PrefSpec					  : FSSpec;			{본New DTSA file spec본}	    Database_Name                 : fnamestr;         {Name of database opened.}    Hall_Name                     : fnamestr;    RdBinaryName                  : fnamestr;    WrtBinaryName                 : fnamestr;    DB_BinaryName                 : fnamestr;    PlainName                     : fnamestr;    SpreadName                    : fnamestr; (* StatViewName                  : fnamestr;    ExelName                      : fnamestr;    KaleidName                    : fnamestr;	*)    MCA_BinaryName                : fnamestr;    MCA_ResultsName               : fnamestr;    Pref_Name                     : fnamestr;    filename                      : fnamestr;    datafilename                  : fnamestr;         {this is used for displaying refs}    The_File_Name                 : fnamestr;    Pref_File                     : fnamestr;    SimpBinName                   : fnamestr;    OutName                       : fnamestr;    BinaryName                    : fnamestr;    FM                            : fnamestr;    Peak_rect                     : Rect;             {Temporary rectangle}    copyRect                      : Rect;    OldBox                        : Rect;    FullWindowRect                : Rect;    ScreenRect                    : Rect;             { For whole screen }    ScratchRect                   : Rect;    Simplex_In_Rect               : Rect;             {Temporary rectangle}    Rect_Strip_Ref_List           : Rect;             {Rectangle for strip peak list}    SiLi_Rect                     : Rect;    SpecNumRect                   : Rect;             {Temporary rectangle}    HeaderRect                    : Rect;             {Temporary rectangle}    tempRect                      : Rect;             {Rect for dragging}    BackPlaneRect                 : Rect;    Acquire_Rect                  : Rect;    ROIRect                       : Rect;             {Temporary rectangle}    ScreenArea                    : Rect;    MaxWindowRect                 : Rect;    Rect_I_Spectra                : Rect;    PrintWindow                   : Rect;    BoxRect                       : Rect;    Rect_Point                    : Point;    SiLi_Pt                       : Point;    Mouselocation                 : Point;    Strip_Pt                      : Point;    Peak_Pt                       : Point;            {Returned point from track}    mytype                        : OsType;    filecreator                   : OsType;    filetype                      : OsType;    scrapType                     : OsType;    spreadcreator                 : OsType;    err                           : OSErr;    ignoreError                   : OSErr;    error                         : OSErr;    grow                          : Size;    Val                           : Size;    Geom                          : Geometry;    environs1                     : SysEnvRec;    cursorRgn                     : RgnHandle;    My                            : real;    One_Coeff                     : real;    Two_Coeff                     : real;    Fat_amount                    : real;    Shift_amount                  : real;    std4                          : real;    std3                          : real;    Diff_gain                     : real;    tocnts                        : real;    Pierson_Num                   : real;    Shift_Ev                      : real;    Partial_Shift                 : real;    Scale_1_Multiplier            : real;    Scale_2_Multiplier            : real;    GasdevGset                    : real;    WW                            : real;    XX                            : real;    YY                            : real;    ZZ                            : real;    zero                          : real;    one                           : real;    dE                            : real;             { Convolver in assembler needs this address }    FWHM                          : real;             { Convolver in assembler needs this address }    WDS_BgnLam                    : real;    WDS_EndLam                    : real;    WDS_Two_d                     : real;    WDS_d_Lambda                  : real;    WDS_MYR                       : real;    WDS_NaCl                      : real;    WDS_KAP                       : real;    WDS_RAP                       : real;    WDS_TAP                       : real;    WDS_PET                       : real;    WDS_LiF                       : real;    WDS_LOD                       : real;    WDS_LDE1                      : real;    WDS_V_C                       : real;    WDS_MoB4C                     : real;    WDS_SiO2_1011                 : real;    WDS_SiO2_1010                 : real;    WDS_Si                        : real;    WDS_Graphite                  : real;    WDS_Pb_Stearate               : real;    WDS_Mica                      : real;    WDS_EDDT                      : real;    WDS_User1                     : real;    WDS_User2                     : real;    Old_Work                      : real;    Old_Results                   : real;    OldSpec1                      : real;    OldSpec2                      : real;    OldSpec3                      : real;    OldSpec4                      : real;    OldSpec5                      : real;    OldSpec6                      : real;    OldSpec7                      : real;    OldSpec8                      : real;    Live_Time                     : real;    Thin_KV                       : real;    Specimen_Thickness            : real;    Bulk_KV                       : real;    Thin_density                  : real;    Bulk_Density                  : real;    Element_Density               : real;    tilt                          : real;    Faraday_Current               : real;    V_Scale_Top                   : real;    V_Scale_Bottom                : real;    V_Scale_Top_Arrow             : real;    V_Scale_Bottom_Arrow          : real;    Multiplier                    : real;    Energy_Estimate               : real;    High_Peak_Meas                : real;    High_Peak_Book                : real;    Low_Peak_Meas                 : real;    Low_Peak_Book                 : real;    Counts_FullScale              : real;    Counts_BottomScale            : real;    Thin_Physics_Constant         : real;    Bulk_Physics_Constant         : real;    DOmega                        : real;    Thin_Fluor_Yield              : real;    Bulk_Fluor_Yield              : real;    Bulk_K_ScaleFactor            : real;    Bulk_L_ScaleFactor            : real;    Bulk_M_ScaleFactor            : real;    Bulk_CONT_ScaleFactor         : real;    Thin_K_ScaleFactor            : real;    Thin_L_ScaleFactor            : real;    Thin_M_ScaleFactor            : real;    Thin_CONT_ScaleFactor         : real;    Strip_One_Gauss_Width         : real;    Strip_One_Gauss_Position      : real;    NM_Alpha                      : real;             { RealToString converts to real }    NM_Beta                       : real;    NM_Gamma                      : real;    Amp_Perturb                   : real;    Energy_Perturb                : real;    Width_Perturb                 : real;    SlopeX                        : real;    SlopeY                        : real;    InterceptX                    : real;    InterceptY                    : real;    Eo                            : real;    Store_Work_Hi                 : real;    Store_Work_Lo                 : real;    Atomic_Weight                 : real;    Extended_Temp                 : real;    PiRt                          : real;    Pi4                           : real;    Pi2                           : real;    aSigConst                     : real;    SigSqMn                       : real;	WDS_Fitting_Resolution        : real;    DetConst                      : real;    AAconst                       : real;    theSigConst                   : real;    Ln2                           : real;    sensi                         : real;    search_Range				  : real;	EDS_eV                        : real; { holding variable }	WDS_eV                        : real; { holding variable }	    Gloldm                        : real {double_t};    Glsq                          : real {double_t};    Glalxm                        : longreal {double_t};    Glg                           : longreal {double_t};	{```}    f_size                        : integer;    MarkerPopup                   : Integer;    Mu_Choice                     : Integer;    OldChan_Num                   : Integer;    Old_Atomic_Number             : Integer;    Num_Noise_Spectra             : Integer;    scrapCompare                  : Integer;    Spectrum_Counter              : Integer;    Range_Keeper                  : Integer;    New_Range                     : Integer;    XCenter                       : Integer;    YCenter                       : Integer;    BoxLeft                       : Integer;    BoxTop                        : Integer;    VLabelColor                   : Integer;    Function_Picker               : Integer;    vrefnum, datafilevrefnum      : Integer;    Applvrefnum                   : Integer;    MCA_Results_VolNum            : Integer;    Binary_Volume_Ref_Num         : Integer;    Default_Volume_Ref_Num        : Integer;    MCA_Home_Res_RefNum           : Integer;    save_vol                      : Integer;    FileRefNum                    : Integer;    In_VolRefNum                  : Integer;	InVol_volname                 : str31;	InVol_DirID                   : longint;	InVol_volnum                  : integer;    Out_VolRefNum                 : Integer;	OutVol_volname                : str31;	OutVol_DirID                  : longint;	OutVol_volnum                 : integer;    MCA_VolRefNum                 : Integer;    {usually Working dir num}	MCA_ResultsDirID              : longint;    {true dir id}	MCA_ResultsVNum               : Integer;    {volume num}    Spectrum_Size                 : Integer;          {this MUST be an integer, for Assy. Lang. Convolver }	Math_Channels				  : Integer;    Number_of_BackGrounds         : Integer;    Number_of_PeakRois            : Integer;    Floor_x                       : Integer;    Ceiling                       : Integer;    Z                             : Integer;    Displayed_Fst                 : Integer;    Displayed_Lst                 : Integer;    AddRef_VolNum                 : Integer;    Binary_VolNum_Write           : Integer;    Pref_VolNum                   : Integer;    Spec_Displayed                : Integer;    Analysis_Results_Counter      : Integer;          { Bob's, for ZAF }    Active_Peak_Label             : Integer;    Label_Counter                 : Integer;    Active_Chemical_Scale         : Integer;    Choice_of_Units               : Integer;    Choice_of_Family              : Integer;    Choice_of_Display             : Integer;    Scale_Button                  : Integer;    EDS_ChanNum_Holder            : Integer;    WDS_ChanNum_Holder            : Integer;    mintofit                      : Integer;    Number_of_Spectra             : Integer;    Lab_Left_Limit                : Integer;    Lab_Right_Limit               : Integer;    Hall_Vol                      : Integer;    Ntemp                         : Integer;    Coperator                     : Integer;    Binary_VolNum_Read            : Integer;    GasdevIset                    : Integer;    Hold_RefNum                   : Integer;    Chan_num_Corrector            : Integer;    WDS_Order                     : Integer;    Clmn1                         : Integer;    Clmn2                         : Integer;    Clmn3                         : Integer;    Chan_num                      : Integer;    Atomic_Number                 : Integer;    cursor_Position               : Integer;    Full_MarkerTOP                : Integer;    Full_MarkerBOTTOM             : Integer;    Windowtest                    : Integer;    Marker_Counter                : Integer;    Xtemp                         : Integer;    Ytemp                         : Integer;    Plt_Syms_Spectrum_Number      : Integer;    ChooseOutputSpectrum          : Integer;    XLo                           : Integer;    YLo                           : Integer;    XHi                           : Integer;    YHi                           : Integer;    Hloc                          : Integer;    Vloc                          : Integer;    ChannelMin                    : Integer;    ChannelMax                    : Integer;    Old_ChannelMin                : Integer;    Old_ChannelMax                : Integer;    seed_x                        : Integer;    seed_y                        : Integer;    seed_z                        : Integer;    Strip_Line_To_Use             : Integer;    Type_Strip_To_Use             : Integer;    Chosen_Region                 : Integer;    Num_of_Fits                   : Integer;    SpinCursorCounter             : Integer;    Begin_End                     : Integer;    glit                          : Integer;    Shell                         : Integer;    Number_of_Elements_Simplexed  : Integer;    indx                          : Integer;    TV                            : Integer;          { location of text }    TH                            : Integer;          { location of text }    Mouse_x                       : Integer;    Mouse_y                       : Integer;    Blink_Timer                   : Integer;    theMenu                       : Integer;    theItem                       : Integer;          {Menu list and item selected}    chCode                        : Integer;          {Key code}    Full_top_Screen               : Integer;    Full_left_Screen              : Integer;    Full_Bottom_Screen            : Integer;    Full_Right_Screen             : Integer;    code                          : Integer;          {Determine event type}    TheTValue                     : Integer;    TheLValue                     : Integer;          {Value of the scrollbar}    Peak_Index                    : Integer;          {For looping}    Points_for_Smooth             : Integer;	LabelSize					  : Integer;	DisplayROI					  : Integer;	Maximum_Iterations			  : Integer;	label_count					  : integer;	Pix_depth					  : integer;    WDS_BgnEDS                    : longint;    WDS_BgnWDS                    : longint;    WDS_EndWDS                    : longint;    Database_dirID                : longint;          {dirID of database.}    Asyctmp                       : longint;    MemResult                     : longint;    InputRate                     : Integer;    OutputRate                    : Integer;    Center_Lobe                   : longint;    Left_Lobe                     : longint;    Right_Lobe                    : longint;    Thin_K_Xsect                  : longint;    Bulk_K_Xsect                  : longint;    Thin_L_Xsect                  : longint;    Bulk_L_Xsect                  : longint;    Thin_M_Xsect                  : longint;    Bulk_M_Xsect                  : longint;    Bulk_CONT_Xsect               : longint;    Thin_CONT_Xsect               : longint;    Bulk_CONT_Xsect_BG            : longint;    Thin_CONT_Xsect_BG            : longint;    Thin_Wk_Choice                : longint;    Thin_Rslt_Choice              : longint;    Thin_S1_Choice                : longint;    Thin_S2_Choice                : longint;    Thin_S3_Choice                : longint;    Thin_S4_Choice                : longint;    Thin_S5_Choice                : longint;    Thin_S6_Choice                : longint;    Thin_S7_Choice                : longint;    Thin_S8_Choice                : longint;    Bulk_Wk_Choice                : longint;    Bulk_Rslt_Choice              : longint;    Bulk_S1_Choice                : longint;    Bulk_S2_Choice                : longint;    Bulk_S3_Choice                : longint;    Bulk_S4_Choice                : longint;    Bulk_S5_Choice                : longint;    Bulk_S6_Choice                : longint;    Bulk_S7_Choice                : longint;    Bulk_S8_Choice                : longint;    Arrow_Signer                  : longint;    Y_Pixel                       : longint;    X_Pixel                       : longint;    Acquisition_Seconds           : longint;    Hold_Time                     : longint;    Start_Time                    : longint;    The_Time                      : longint;    Finish_Time                   : longint;    Ticks                         : longint;          { keeps track of time }    SiLi_Energy_Value             : longint;          {Value of the energy scrollbar}    SiLi_Vert_Value               : longint;          {Value of the vertical scrollbar}    SiLi_Thumb_Position           : longint;    Delta                         : longint;    mResult                       : longint;          {Menu list and item selected values}    WDS_Active                    : Boolean;    Ge_Active                     : Boolean;    Si_Active                     : Boolean;    ZAF_Run                       : Boolean;    ZAF_Active                    : Boolean;    Hall_Active                   : Boolean;    Whole_Cell_Active             : Boolean;    Cliff_Lorimer_Active          : Boolean;    Standardless_Active           : Boolean;    CitZAF_Active                 : Boolean;	CitZAF_Run                    : Boolean;	Cit_Particle_Active           : Boolean;    DataBase_Open                 : Boolean;          {Use to tell program to reopen database.}    OpenNew_Database              : Boolean;          {Use to open a different database.}	    CIT_Initialized               : Boolean;    Ready_to_Save_WDS             : Boolean;    Activate                      : Boolean;    ShowMarkers                   : Boolean;    Marker_Plot                   : Boolean;    Strip_Refs_Active             : Boolean;    Private                       : Boolean;          { set in MCA.P }    demo_DTSA                     : Boolean;          { set in MCA.P }    Majors                        : Boolean;    Minors                        : Boolean;    Satellites                    : Boolean;    Xray_Data_Request             : Boolean;    saved_displayed               : Boolean;    Do_Calc                       : Boolean;    DebugerON                     : Boolean;    MCA_OptionsBoolean            : Boolean;    append_ref                    : Boolean;    display_ref                   : Boolean;    delete_ref                    : Boolean;    Scale_Changed_Event           : Boolean;    OneShot                       : Boolean;          { Used in Find Nearest Peak }    Nearest_K                     : Boolean;    Nearest_L                     : Boolean;    Nearest_M                     : Boolean;    Clr_One                       : Boolean;    Clr_Family                    : Boolean;    One_Label                     : Boolean;    Some_Labels                   : Boolean;    All_Labels                    : Boolean;    read_Hall_file                : Boolean;    Make_Hall                     : Boolean;    DoubleClick                   : Boolean;    stopButton                    : Boolean;    Calibrate_Energy_Scale        : Boolean;    File_Calibration		      : Boolean;    Called_for_Generate           : Boolean;    dummy_Boolean                 : Boolean;    ASCII_Out_finished            : Boolean;    save_work_open                : Boolean;    Called_for_Work_Spec          : Boolean;    MouseUp_Waiting               : Boolean;    Attach_Fields_to_Ascii_Spectrum: Boolean;    WDS_Angstroms                 : Boolean;    WDS_Sin_Theta                 : Boolean;    WDS_millimeters               : Boolean;    WDS_Convert_X_and_Y_axis      : Boolean;    WDS_Convert_only_X_axis       : Boolean;    hasWNE                        : Boolean;    MCA_Spectrum_Active           : Boolean;    Constraint_Switch             : Boolean;    Results_Added                 : Boolean;    Simplex_Active                : Boolean;    LLSQ_Active                   : Boolean;    Marker_Sums                   : Boolean;    Marker_Escapes                : Boolean;    Marker_Satellites             : Boolean;    Marker_Peaks                  : Boolean;    Marker_Edges                  : Boolean;    Marker_WDS                    : Boolean;    ChangedSelection              : Boolean;    stop_Acquiring                : Boolean;    Acquiring                     : Boolean;    KludgeBoolean                 : Boolean;    is_batch                      : Boolean;    WtSwitch                      : Boolean;    Incomplete_Charge_Switch      : Boolean;    scrapDirty                    : Boolean;    inBackground                  : Boolean;    Plain_Boolean                 : Boolean; (* StatView_Boolean              : Boolean;    Exel_Boolean                  : Boolean;    Kaleid_Boolean                : Boolean; *)	Spread_boolean                : Boolean;    MCA_File_Boolean              : Boolean;    Bulk_Physics_Boolean          : Boolean;    Thin_Physics_Boolean          : Boolean;    Normal_Output                 : Boolean;    Reduced_Output                : Boolean;    SpecWork_has_been_Changed     : Boolean;    Fit_Invisibly                 : Boolean;    DragDance                     : Boolean;    DragBox                       : Boolean;    BoxVisable                    : Boolean;    DragLabel                     : Boolean;    KLM_Boolean                   : Boolean;    Expert                        : Boolean;          { Used to turn on or off extra and real help boxes }    Expert_got_Clicked            : Boolean;    abort_x                       : Boolean;    Start_Up                      : Boolean;    Clear_Start_Acquire           : Boolean;    Stop_Acquire                  : Boolean;    Continue_Acquire              : Boolean;    Clear_Acquire                 : Boolean;    Elements_Chosen               : Boolean;    Running_Bulk_Mode             : Boolean;    Running_Thin_Mode             : Boolean;    K_Peak_2_Bkg                  : Boolean;    L_Peak_2_Bkg                  : Boolean;    M_Peak_2_Bkg                  : Boolean;    File_Cancel_Button            : Boolean;    SiLi_Response_Calculated      : Boolean;    SiLi_Buffer_Calculated        : Boolean;    BG_Active                     : Boolean;    Show_ROI                      : Boolean;	Use_Manual_ROIs               : Boolean;    Roi_Showing                   : Boolean;    Peak_12                       : Boolean;    BackGround_12                 : Boolean;    Peak_Wipe                     : Boolean;    BackGround_Wipe               : Boolean;    Quant_BackGround_Wipe         : Boolean;    Clear_ROI                     : Boolean;    Scale_ROI                     : Boolean;    ROI_Window_Active             : Boolean;    SiLi_Window_Active            : Boolean;    StripPeak_Window_Active       : Boolean;    Calibrate_Window_Active       : Boolean;    ID_Window_Active              : Boolean;    Pick_Window_Active            : Boolean;    Simplex_Results_Active        : Boolean;    LLSQ_Window_Active            : Boolean;    First_Time                    : Boolean;    Auto_Scale_Display            : Boolean;    Bipolar_Display               : Boolean;    Linear_Display                : Boolean;    Square_Root_Display           : Boolean;    Log_Scale_Display             : Boolean;    Sum_Peaks                     : Boolean;    Mouse_Function_Expand         : Boolean;    Mouse_Function_Contract       : Boolean;    Mouse_Vert_Expand             : Boolean;    Mouse_Vert_Contract           : Boolean;    RightArrow                    : Boolean;    LeftArrow                     : Boolean;    UpArrow                       : Boolean;    DownArrow                     : Boolean;    ScratchPlot                   : Boolean;    Quick_Exit                    : Boolean;    Is_A_Dialog                   : Boolean;                   {Flag for modless dialogs}    Blinker                       : Boolean;    wasDown                       : Boolean;                   {used to obscure cursor after click in text}    doneFlag                      : Boolean;                   {Exit DTSA flag}	ItsBeenAcquired               : Boolean;	QuitBusyMessage               : Boolean;	RefreshScreen_Finished        : Boolean;	Do_it_in_the_Dark			  :	Boolean;	Comp_handles				  : boolean;		{ ## Comp Database handles ##}	Kill_citZAF					  : boolean;	Qual_Incomplete				  : boolean;	Halt_Qual					  : boolean;	No_Header_in_Print			  : boolean;		{본 2/16/94 본}	Do_HallOutput   			  : boolean;		{본 10/13/94 본}	Do_CLOutput     			  : boolean;		{본 10/13/94 본}		See_Fit					      : boolean;		{본 2/8/95 본}	Do_ascii					  : boolean;		{본 9/95 본}	Qual_DTSA_True				  : boolean;		{본 5/19/95 본}	Do_Fit_Results				  : boolean;	ChangePixDepth				  : boolean;	QC_Enabled					  : boolean;	QC_running					  : boolean;	QC_SEM						  : boolean;	    Spectrum_Full                 : ARRAY [1..10] OF Boolean;  {9=results,10=work}    deepDeviceHdl                 : GDHandle;    savedDevice                   : GDHandle;    MainDevice					  : GDHandle;        Color_Info					  : ColorPickerInfo;		{본3/14/96본볗    Text_Color                    : RGBColor;    PeakROI_Color                 : RGBColor;    BkgROI_Color                  : RGBColor;    ScaleROI_Color                : RGBColor;    QuantROI_Color                : RGBColor;    Axes_Color                    : RGBColor;    the_Color                     : RGBColor;    PeakLabel_Color               : RGBColor;    KLMColor                      : RGBColor;    aRGB                          : RGBColor;    Black_Color                   : RGBColor;    White_Color                   : RGBColor;    BackGround_Color              : RGBColor;    SpectrumColor                 : ARRAY [1..10] OF RGBColor;    colorPort                     : CGrafPort;      colorPPtr                     : CGrafPtr;    ChanNumCGPtr                  : CGrafPtr;    ChanKvCGPtr                   : CGrafPtr;    LeftHLCGPtr                   : CGrafPtr;    SpecIDInfoCGPtr               : CGrafPtr;    UpVLCGPtr                     : CGrafPtr;    WorkCntsCGPtr                 : CGrafPtr;    ResultsCntsCGPtr              : CGrafPtr;    AtomicNumberCGPtr             : CGrafPtr;    TopCGPtr                      : CGrafPtr;    LeftCGPtr                     : CGrafPtr;    BottomCGPtr                   : CGrafPtr;    SavedPort                     : CGrafPtr;    SavePort                      : CGrafPtr;         { Used to save a grafport }    tempMenu                      : MenuHandle;    MainMenu                      : MenuHandle;       {  after insert this is last menu item}    FullMenu                      : MenuHandle;       { The Full menu handle }    ManageMenu                    : MenuHandle;    AppleMenu                     : MenuHandle;       {Used to handle DAs, needed for later use}    M_Ml_References               : MenuHandle;    M_MCA_Setups                  : MenuHandle;    M_Standards_Files             : MenuHandle;	M_CITZAF					  : MenuHandle;	M_Label_Fonts	              : MenuHandle;    M_CliffLorimer                : MenuHandle;	M_Show_Header				  : MenuHandle;	M_Acquisition				  : MenuHandle;	M_Stdlss					  : MenuHandle;	M_Qual_out1					  : MenuHandle;	M_Qual_out2					  : MenuHandle;	M_QC						  : MenuHandle;	M_Hall_Analysis				  : MenuHandle;	    MathWindow                    : WindowPtr;    MAINPtr                       : WindowPtr;        { pointer to results window }    Strip_Peakwindow              : WindowPtr;        { Global window pointer to Strip_Peak window }    PickWindow                    : WindowPtr;    Main_ID_Window                : WindowPtr;        {Window pointer}    Header_Info_Window            : WindowPtr;        {Window pointer}    BackPlane                     : WindowPtr;    AcquireWindow                 : WindowPtr;    whichWindow                   : WindowPtr;        {See which window for event}    SiLiWindow                    : WindowPtr;        {Window pointer}    TextWindow                    : WindowPtr;        {Window pointer}    ROIWindow                     : WindowPtr;        {Window pointer}    CLPicker                      : WindowPtr;    SiLi_Dialog                   : DialogPtr;        { 본본본These should be local}    Geom_Dialog                   : DialogPtr;    Elements_Dialog               : DialogPtr;    Header_Dialog                 : DialogPtr;    Calibrate_GetSelection        : DialogPtr;	BusyMessage                   : DialogPtr;    theKeys                       : KeyMap;    myDCInfo                      : DataCommInfo;    {List_I_Spectra                : ListHandle;}    Strip_Ref_List                : ListHandle;       {Handle for strip peak list}    cList                         : ListHandle;    Rect_I_List1                  : Rect;    Ref_Stuff                     : RefS;    Plt_Spec                      : ARRAY [1..10] OF WorkS;	    XIntPtr                       : IntArrayPtr;    YIntPtr                       : IntArrayPtr; 	Generated                     : GenStuff_ptr;	InFront_Detector              : GenStuff_ptr;	InFront_Detector_Fluor        : GenStuff_ptr;	Inside_Detector               : GenStuff_ptr;	Line_Energy                   : GenStuff_ptr;    Bkg_ResponseFnc               : Col_ptr;    Gen_ResponseFnc               : Col_ptr; 	Col_1                         : Col_ptr;	Col_2                         : Col_ptr;	Col_3                         : Col_ptr;	Col_4                         : Col_ptr;	Col_5                         : Col_ptr;	Col_6                         : Col_ptr;	Bkg_P                         : Bkg_Ptr;	Gen_P                         : Gen_Ptr;	Composite_P                   : Composite_Ptr;	Det_Effic_P                   : Det_Effic_Ptr;	mu_rho_P                      : mu_rho_Ptr;	f_chi_P                       : f_chi_Ptr;	Ob_Pks_P                      : Ob_Pks_Ptr;         Hall_Output                   : HallOutHdl;    Hall_Setup                    : HallHdl;	CL_BsSetup					  : CLBsHdl;	CL_Setup					  : ARRAY [1..MaxNumPks] OF ClHdl;	CL_Output					  : CLOutHdl;    BigHndl                       : Big_A;    theFFTHdl                     : FFTHdl;    periodic_picks                : NPKARRAY;    AsycTaskPtr                   : VBLTaskPtr;    AsycAlivePtr                  : TMTaskPtr;    {DeferedtaskPtr                : dtTaskPtr;}    theGetRslBlk                  : TGetRslBlk;    theSetRslBlk                  : TSetRslBlk;    thePrRec                      : THPrint;    thePrPort                     : TPPrPort;    theStatus                     : TPrStatus;    CursH                         : CursHandle;    theCursorHandle               : CursHandle;    CurrentC                      : Ptr;              {Pointer to current displayed cursor}    LastC                         : Ptr;              {Pointer to last displayed cursor}    DragC                         : Ptr;              {flat hand}    ArrowC                        : Ptr;    SpinC1                        : Ptr;    SpinC2                        : Ptr;    SpinC3                        : Ptr;    SpinC4                        : Ptr;    SpinC5                        : Ptr;    SpinC6                        : Ptr;    SpinC7                        : Ptr;    SpinC8                        : Ptr;    SpinC9                        : Ptr;    SpinC10                       : Ptr;    SpinC11                       : Ptr;    SpinC12                       : Ptr;    SpinC13                       : Ptr;              {Spinning electrons cursors}    CtrlHandle                    : ControlHandle;         SiLi_AcqCntlHdl               : ControlHandle;    SiLi_InCntHdl                 : ControlHandle;    SiLi_OutCntHdl                : ControlHandle;    SiLi_512CntHdl                : ControlHandle;    SiLi_1024CntHdl               : ControlHandle;    SiLi_2048CntHdl               : ControlHandle;    SiLi_4096CntHdl               : ControlHandle;    SiLi_8192CntHdl               : ControlHandle;    SiLi_CtrlHandle               : ControlHandle;	SiLi_CtrlHdl_Mark             : ControlHandle;    AutoScale_CtrlHandle          : ControlHandle;         Si_Li_Bipolar                 : ControlHandle;    Vertical_SiLi_CtrlHandle      : ControlHandle;    Energy_SiLi_CtrlHandle        : ControlHandle;    SiLi_Control                  : ControlHandle;    SiLi_R1Control                : ARRAY [1..4] OF ControlHandle;    SiLi_R3Control                : ARRAY [1..3] OF ControlHandle;	SiLi_CalibCntlHdl             : ControlHandle;	{*** bob 11/3/92 ***}	SiLi_DoFitCntlHdl             : ControlHandle;	{*** bob 04/25/94 ***}	SiLi_AddFitCntlHdl             : ControlHandle;	{*** bob 04/25/94 ***}	SiLi_SeeFitCntlHdl             : ControlHandle;	{*** bob 04/25/94 ***}			myEvent                       : EventRecord;      {Event record for all events} 		ImBusy							: DialogPtr; { Global_Functions.p }		theDateTime					  	: DateTimeRec; { Physics_Windows.p, Sandia }		theValues						: Sili_rec;    { Physics_Windows.p }		Cancel_Boolean   				: Boolean; { MathWin.p }    	Peak_Energy						: PKARY;	{ double_t Simplexer.p}    	PkAmpInfo						: ARRAY [1..MaxNumPks] OF WtngInfo; {integer and real Simplexer.p}        BigAutoFitExit					: Boolean; { Simplexer.p }        CommaDown						: Boolean; { Simplexer.p }		file_ready					 	: boolean;  { ZAF.p }	CONST		Serial_BufferSize          =  32000; {Automation.p}	TYPE   		PAC256Buffer    = PACKED ARRAY [1..Serial_BufferSize]  OF  char;{Automation.p}		PAC256BufPtr    = ^PAC256Buffer;	{Automation.p}    var	      ipCount         : Longint;           { how many characters were read}{Automation.p}      ipBufPtr        : PAC256BufPtr;      { ptr to input buffer}{Automation.p}       SERIAL_Active                 : Boolean; { Tools2.p } 	  M_Old_Fit_File                : MenuHandle; { MENUS.p }           FileInfo                      : AppFile;  {mca.p}       {Passes info to open, save routines}      ErrG                          : osErr;{mca.p}      Message, count, IT, indexer   : integer;{mca.p}	  SelectWindow_Occurred         : Boolean;{mca.p}	  {bytecount						: longint;}{mca.p} 	  Lindexer,Lnum                 : Longint;{mca.p}	  Do_a_Resize                   : Boolean;{mca.p}	  CharCounter                   : Longint;{mca.p}	  str                           : str255;{mca.p}	  window                        : WindowPtr;{mca.p}      index                         : Integer;{mca.p}		  Gaussian_Energy              : ARRAY [1..10] OF real;	  Gaussian_Width               : ARRAY [1..10] OF real;	  Gaussian_Amplitude           : ARRAY [1..10] OF real;{in Sandia}Plain_VolNum,Spread_VolNum	 :integer;(*Stat_VolNum, Exel_volnum,Kal_VolNum		 : integer;	*)Plain_Options, Show_Quant	 : boolean;QuantName					 : fnamestr;binary_choice		         : boolean;OnePlain                     : text;            { File Variable in Curve Fit output }TYPE	aFamily =		record			Z			: integer;	{value is 1...95}			skip_fam	: integer;			Roi	    	: integer;	 {value is 1...maxnumpks}		end;    Families = array[1..maxnumpks] of aFamily;	FamilyPtr = ^Families;	FamilyHdl = ^FamilyPtr;VAR		SkipFam		: FamilyHdl;	{these two variables are for deselecting lines in...}	Skip_some   : boolean;		{...Simplex fitting}Col_Label				: array[0..Max_Line_Peaks] of string[10];	{In Qual_Scan}Energy_Label			: array[0..Max_Line_Peaks] of real;	{In Qual_Scan}TYPE	pBlock				= HParamBlockRec;VAR	paramBlock				: pBlock;IMPLEMENTATIONEND.